<% if events
     data_events = events.map do |event|
       [event.event,
        event.actions.map do |action|
          params = case action.type.to_s
                                when 'replaces' then
                                  {grid_nesting:@grid_nesting,
                                   target: action.params[:target],
                                   presenter: action.params[:presenter]}
                                when 'update', 'post', 'delete' then
                                  {__parent_id__: parent_id}
                                when 'snackbar' then
                                  {text: action.params[:text]}
                                when 'loads' then
                                  {}
                                when 'replaces', 'toggle_visibility', 'dialog' then
                                  {target: action.params[:target]}
                                else
                                  {}
                              end
          [action.type, action.url, params[:target], params]
        end
       ]
     end %>
  data-events = '<%= data_events.to_json %>'
<% end %>
